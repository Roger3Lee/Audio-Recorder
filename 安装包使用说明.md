# AudioRecorder 安装包使用说明

## 📦 安装包文件

生成的安装包文件：`AudioRecorder_Professional.msi`

## ✨ 安装包功能特性

### 🎯 完整的安装体验
- ✅ **安装目录选择**：用户可以自定义安装路径
- ✅ **安装进度显示**：实时显示安装进度
- ✅ **开始菜单集成**：自动创建开始菜单快捷方式和卸载快捷方式
- ✅ **桌面快捷方式**：自动创建桌面快捷方式
- ✅ **系统集成**：完整的卸载信息注册

### 🛡️ 智能版本管理
- ✅ **防止重复安装**：自动检测已安装版本
- ✅ **版本升级**：支持无缝升级到新版本
- ✅ **降级保护**：防止安装较低版本
- ✅ **注册表管理**：正确的注册表项目管理

### 🔧 高级功能
- ✅ **产品信息完整**：包含版本、制造商、帮助链接等
- ✅ **图标支持**：使用应用程序图标
- ✅ **用户权限友好**：使用 HKCU 注册表，无需管理员权限
- ✅ **清理功能**：卸载时完整清理所有组件

## 🚀 使用方法

### 构建安装包
```bash
# 运行构建脚本
build_simple.bat
```

### 安装过程
1. **双击 `AudioRecorder_Professional.msi`**
2. **欢迎界面**：显示欢迎信息
3. **许可协议**：阅读并接受许可协议（如果有）
4. **选择安装目录**：可自定义安装路径（默认：`C:\Program Files\AudioRecorder`）
5. **确认安装**：确认安装设置
6. **安装进度**：实时显示安装进度
7. **完成安装**：安装完成，可选择立即启动程序

### 卸载过程
#### 方法1：通过开始菜单
1. 开始菜单 → AudioRecorder → 卸载 AudioRecorder

#### 方法2：通过控制面板
1. 控制面板 → 程序和功能 → AudioRecorder → 卸载

#### 方法3：通过设置
1. 设置 → 应用 → AudioRecorder → 卸载

## 📁 安装后的文件结构

```
C:\Program Files\AudioRecorder\
├── AudioRecorder.exe          # 主程序
└── [其他支持文件]

开始菜单：
├── AudioRecorder              # 启动快捷方式
└── 卸载 AudioRecorder         # 卸载快捷方式

桌面：
└── AudioRecorder              # 桌面快捷方式
```

## 🗂️ 注册表项目

安装后会在以下注册表位置创建条目：

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Uninstall\AudioRecorder
├── DisplayName = "AudioRecorder"
├── DisplayVersion = "1.0.0"
├── Publisher = "AudioRecorder Team"
├── InstallLocation = "[安装路径]"
├── UninstallString = "msiexec /x [ProductCode]"
└── DisplayIcon = "[安装路径]\AudioRecorder.exe"

HKEY_CURRENT_USER\Software\AudioRecorder
├── InstallDir = "[安装路径]"
└── Version = "1.0.0"
```

## 🔍 故障排除

### 安装失败
1. **权限问题**：虽然不需要管理员权限，但如果遇到问题，可以右键 → 以管理员身份运行
2. **路径问题**：确保选择的安装路径存在且可写
3. **磁盘空间**：确保有足够的磁盘空间（约 200MB）

### 卸载不完整
1. 手动运行：`msiexec /x {产品代码}`
2. 清理注册表：删除相关注册表项目
3. 删除文件夹：手动删除安装目录

### 重复安装问题
- 安装包会自动检测并阻止重复安装
- 如需重新安装，请先卸载现有版本

## 📋 版本历史

### v1.0.0
- 初始版本
- 完整的安装/卸载功能
- 桌面录音控制器功能
- URL协议支持
- WebSocket控制接口

## 📞 技术支持

如遇到安装或使用问题，请：
1. 检查系统要求（Windows 8.1+，.NET 8.0+）
2. 查看日志文件（如果有）
3. 联系技术支持

---

**注意**：这是专业版安装包，包含完整的安装体验和智能版本管理功能。
